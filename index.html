<html lang="en">
<head>
	<title>-OD</title>
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<style>
	body {
		font-family: Monospace;
		margin: 0px;
		overflow: hidden;
	}
	</style>
</head>
<body>

	<script src="three.min.js"></script>
	<script>

	var camera, scene, renderer;
	var sphere;
	var cones = [];
	var coneCount = 500;
		
	init();
	animate();

	function init() {

		scene = new THREE.Scene();

		camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 1, 1000 );
		camera.position.z = 2;

		var sphereGeom = new THREE.SphereGeometry(1, 30	 ,30);
		sphere = new THREE.Mesh(sphereGeom, new THREE.MeshBasicMaterial( { color: 0x00ffaa, wireframe: true } ));
		scene.add(sphere)



		var coneGeom = new THREE.SphereGeometry(0.05, 4, 4);//CylinderGeometry(0, 0.1, 0.3);
		//coneGeom.applyMatrix( new THREE.Matrix4().makeRotationFromEuler( new THREE.Euler( Math.PI / 2, Math.PI, 0 ) ) )

		for(var i = 0; i < coneCount; i++){
			var cone = new THREE.Mesh(coneGeom, new THREE.MeshBasicMaterial( { color: 0xaaff00, wireframe: true } ));
			scene.add(cone)
			var v = sphericalToCartesian(randomSpherePoint().sub(new THREE.Vector3(0.05,0,0)));
			cone.position.set(v.x, v.y, v.z);
			//console.log(sphericalToCartesian(randomSpherePoint()))
			cone.lookAt(sphere.position);
			cones.push(cone);
		}
		renderer = new THREE.WebGLRenderer();
		renderer.setClearColor( 0xf0f0f0 );
		renderer.setPixelRatio( window.devicePixelRatio );
		renderer.setSize( window.innerWidth, window.innerHeight );
		document.body.appendChild( renderer.domElement );
		

	}

	//TODO make spherical to cartesian 

	function sphericalToCartesian(v){
		var r = v.x;
		var theta = v.y;
		var phi = v.z;
		var x = r * Math.cos(theta) * Math.sin(phi);
		var y = r * Math.sin(theta) * Math.sin(phi);
		var z = r * Math.cos(phi);
		return(new THREE.Vector3(x, y, z));
	}

	/*
	 *  theta = Random between -Pi, Pi
	 *  phi = 2*arcsin(sqrt(random()))
	 */

	function randomSpherePoint(){
		var theta = (Math.random() * 2 * Math.PI) - Math.PI;
		var phi = 2 * Math.asin(Math.sqrt(Math.random()));
		return(new THREE.Vector3(1, theta, phi))
	}

	function animate() {

		requestAnimationFrame( animate );

		camera.lookAt(scene.position);
		render();

	}

	function render() {

		renderer.render( scene, camera );

	}

	</script>

</body>
</html>
